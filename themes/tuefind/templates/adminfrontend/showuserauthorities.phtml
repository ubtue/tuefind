<h3>User Authorities</h3>
<?php if (count($this->users) == 0): ?>
  <p>No user has requested access to any authority record so far.</p>
<?php else: ?>
  <table class="table">
    <tr>
      <th><?=$this->transEsc('Username')?></th>
      <th><?=$this->transEsc('First Name')?></th>
      <th><?=$this->transEsc('Last Name')?></th>
      <th><?=$this->transEsc('Email Address')?></th>
      <th><?=$this->transEsc('Author')?></th>
      <th><?=$this->transEsc('Status')?></th>
      <th><?=$this->transEsc('Actions')?></th>
    </tr>
    <?php foreach ($this->users as $user): ?>
      <tr>
        <td><?=$user->username?></td>
        <td><?=$user->firstname?></td>
        <td><?=$user->lastname?></td>
        <td><?=$user->email?></td>
        <td><a href="/Authority/<?=urlencode($user->authority_id)?>"><?=$user->authority_id?></a></td>
        <td><?=$user->access_state?></td>
        <td>
          <?php if ($user->access_state == 'requested'): ?>
            <a href="<?=$this->url('authority-process-request', ['user_id' => $user->user_id, 'authority_id' => $user->authority_id])?>" data-lightbox="">process request</a>
          <?php endif; ?>
        </td>
      </tr>
    <?php endforeach; ?>
  </table>
<?php endif; ?>
